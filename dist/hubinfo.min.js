/*!
 * hubinfo - A client side github widget for repo info
 * v0.2.0
 * http://projects.jga.me/hubinfo/
 * copyright Greg Allen 2013
 * MIT License
*/
(function(t){var e=function(e,a,o){t.ajax({url:"https://api.github.com/repos/"+e+"/"+a,dataType:"jsonp",success:function(t){if("Not Found"==t.data.message)throw Error("Invalid user or repo");o(t.data)}})},a=function(e,a,o){t.ajax({url:"https://api.github.com/repos/"+e+"/"+a+"/commits",dataType:"jsonp",success:function(t){var e=t.data[0];o(e)}})},o=function(t,o,r){var n,s,i=0,m=2,c=function(){i==m&&r(n,s)};e(t,o,function(t){i++,n=t,c()}),a(t,o,function(t){i++,s=t,c()})},r=function(t){if("string"==typeof t){var e=t.split("T")[0].split("-");t=new Date(e[0],e[1]-1,e[2])}var a=(new Date).getTime(),o=a-t.getTime(),r=Math.floor(o/864e5);return 0===r?"today":r>30?Math.floor(r/30)+" month(s) ago":r+" day(s) ago"};t.fn.hubInfo=function(e){var a=t.extend({},t.fn.hubInfo.defaults,e),n=this;return o(a.user,a.repo,function(e,o){a.debug&&console.log(arguments),n.each(function(n,s){var i=t(a.template);i.find(".repo-lang").html(e.language).end().find(".repo-watchers").html(e.watchers).attr("href",e.html_url).end().find(".repo-forks").html(e.forks).attr("href",e.html_url).end().find(".repo-name").html(e.name).attr("href",e.html_url).end().find(".repo-commit-message").html(o.commit.message).attr("href","https://github.com/"+a.user+"/"+a.repo+"/commit/"+o.sha).end().find(".repo-commit-date span").html(r(o.commit.committer.date)).end();var m=t(s);m.html(i),m.trigger("render")})}),n},t.fn.hubInfo.defaults={user:"",repo:"",debug:!1,template:['<div class="github-repo">','<div class="repo-header">','<div class="repo-stats">','<span class="repo-lang"></span>','<a class="repo-watchers"></a>','<a class="repo-forks"></a>',"</div>","<div>",'<a class="repo-name"></a>',"</div>","</div>",'<div class="repo-commit">','<a class="repo-commit-message"></a>','<div class="repo-commit-date">committed <span></span></div>',"</div>","</div>"].join("")}})(jQuery);